<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Admin Dashboard - Online Library</title>
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        body {
          font-family: Arial, sans-serif;
          background-color: #f5f9ff;
          margin: 0;
          padding: 0;
        }

        header {
          background-color: #003366;
          color: white;
          text-align: center;
          padding: 15px;
        }

        .container {
          width: 90%;
          margin: 20px auto;
          background: white;
          border-radius: 8px;
          padding: 20px;
          box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }

        h2 {
          text-align: center;
          color: #003366;
        }

        form {
          display: grid;
          grid-template-columns: repeat(2, 1fr);
          gap: 10px;
          margin-bottom: 20px;
        }

        input, select {
          padding: 10px;
          border-radius: 5px;
          border: 1px solid #ccc;
        }

        button {
          background-color: #003366;
          color: white;
          border: none;
          padding: 10px 20px;
          border-radius: 5px;
          cursor: pointer;
        }

        button:hover {
          background-color: #0055aa;
        }

        table {
          width: 100%;
          border-collapse: collapse;
          margin-top: 15px;
        }

        th, td {
          padding: 10px;
          border: 1px solid #ddd;
          text-align: center;
        }

        th {
          background-color: #003366;
          color: white;
        }

        .delete-btn {
          background-color: red;
          padding: 5px 10px;
          border: none;
          color: white;
          border-radius: 4px;
          cursor: pointer;
        }

        .delete-btn:hover {
          background-color: darkred;
        }

        .logout {
          float: right;
          background-color: #e60000;
          margin-top: -10px;
        }

        .logout:hover {
          background-color: #cc0000;
        }
    </style>
</head>
<body>
<header>
    <h1>üìö Admin Dashboard - Online Library</h1>
    <button class="logout" onclick="logout()">Logout</button>
</header>

<div class="container">
    <h2>Add a New Book</h2>
    <form id="bookForm">
        <input type="text" id="title" placeholder="Book Title" required>
        <input type="text" id="author" placeholder="Author Name" required>
        <input type="text" id="category" placeholder="Category" required>
        <input type="number" id="price" placeholder="Price" required>
        <button type="submit">Add Book</button>
    </form>

    <h2>Available Books</h2>
    <table>
        <thead>
        <tr>
            <th>ID</th>
            <th>Title</th>
            <th>Author</th>
            <th>Category</th>
            <th>Price</th>
            <th>Action</th>
        </tr>
        </thead>
        <tbody id="bookTable"></tbody>
    </table>
</div>

<script>
    async function loadBooks() {
      const table = document.getElementById("bookTable");
      table.innerHTML = "<tr><td colspan='6'>Loading...</td></tr>";

      const res = await fetch("http://localhost:8080/api/books/all");
      if (res.ok) {
        const books = await res.json();
        if (books.length === 0) {
          table.innerHTML = "<tr><td colspan='6'>No books found</td></tr>";
          return;
        }
        table.innerHTML = books.map(b => `
          <tr>
            <td>${b.id}</td>
            <td>${b.title}</td>
            <td>${b.author}</td>
            <td>${b.category}</td>
            <td>‚Çπ${b.price}</td>
            <td><button class='delete-btn' onclick='deleteBook(${b.id})'>Delete</button></td>
          </tr>
        `).join('');
      }
    }

    document.getElementById("bookForm").addEventListener("submit", async (e) => {
      e.preventDefault();

      const book = {
        title: title.value.trim(),
        author: author.value.trim(),
        category: category.value.trim(),
        price: parseFloat(price.value)
      };

      const res = await fetch("http://localhost:8080/api/books/add", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(book)
      });

      if (res.ok) {
        alert("‚úÖ Book added successfully!");
        document.getElementById("bookForm").reset();
        loadBooks();
      } else {
        alert("‚ùå Failed to add book.");
      }
    });

    async function deleteBook(id) {
      if (!confirm("Are you sure you want to delete this book?")) return;
      const res = await fetch(`http://localhost:8080/api/books/delete/${id}`, { method: "DELETE" });
      if (res.ok) {
        alert("üóëÔ∏è Book deleted successfully!");
        loadBooks();
      } else {
        alert("‚ùå Failed to delete book.");
      }
    }

    function logout() {
      window.location.href = "login.html";
    }

    loadBooks();
</script>
</body>
</html>
